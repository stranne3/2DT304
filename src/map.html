<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" name="viewport" content="width=device-width">
    <title>Crowding in exercise tracks</title>
    <link type="text/css" href="css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body>
    <div class="sidenav" style="width:70px">
      <a href="/" class="w3-bar-item w3-button"><i class="fa fa-home fa-2x "></i></a>
      <a href="/charts" class="w3-bar-item w3-button"><i class="fa fa-bar-chart fa-2x"></i></a>
      <a href="/map" class="w3-bar-item w3-button"><i class="fa fa-location-arrow fa-2x"></i></a>
      <a href="/about" class="w3-bar-item w3-button"><i class="fa fa-info-circle fa-2x"></i></a>
    </div>
    <h1>Location</h1>

    <button id="sendLocation" onclick="postForm()">Klicka här</button>
  </body>
  <script type="text/javascript">
    var c = {};
    async function postForm() {
      getLoc()
    }

    async function getLoc() {
      if(!navigator.geolocation) {
        alert("Geolocation is not supported by your browser.")
      } else {
          navigator.geolocation.getCurrentPosition(await showPos, error)
        }
    }

    function error() {
      alert("Unable to retreive your location.")
    }

    async function showPos(position) {
      var form = document.createElement("form");
        form.setAttribute("method", "POST");
        //form.setAttribute("action", "/")
        form.setAttribute("hidden", true)
        
        var lat = document.createElement("input");
        lat.setAttribute("type", "text")
        lat.setAttribute("name", "lat")
        lat.setAttribute("value", position.coords.latitude)
        form.appendChild(lat)

        var long = document.createElement("input");
        long.setAttribute("type", "text")
        long.setAttribute("name", "long")
        long.setAttribute("value", position.coords.longitude)

        form.appendChild(long)
        var time = document.createElement("input");
        time.setAttribute("type", "text")
        time.setAttribute("name", "time")
        time.setAttribute("value", position.timestamp)

        form.appendChild(time)
        document.body.appendChild(form)
        form.submit();
        alert("Succesfully submitted your location!")
    }
  </script>
  </body>
  
  <div class="footer">
    © Copyright 2022, Emil Dalin-Volsing, Enida Ahmic and Viktor Stranne Last updated on 13 Mar 2022.
  </div>
</html>
